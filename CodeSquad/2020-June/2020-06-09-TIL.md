# 2020-06-09-TIL

## 오늘 할 일

- [ ] C4 Model 작성
- [ ] Mock API 뭐 만들지 정하기
- [ ] DB schema 작성
- [ ] 로그인 기능 검토
- [ ] Spring 백기선님 강의 듣기
- [ ] Algorithm 문제 풀기
- [ ] Brian 과제 검토

## Jenkins 정리

이 정리는 Local 환경에서 Jenkins 서버를 Docker에 설치하고 Github 연동을 하는것을 목표로 합니다.

Jenkins는 CI&CD를 환경을 제공하는 자동화 서버입니다.

Jenkins를 Local에 Docker로 설치하는 이유는 EC2에 설치하는 공식 가이드를 참조해보면 월 84$ 정도의 비용이 예상된다고 나와있는데, 딱봐도 그냥 우리집 전기세가 덜 나올 것 같아서 데스크톱으로 설정하도록 하였다.

```shell
$ docker pull jenkins/jenkins:lts
```

Docker Hub에서 jenkins 이미지를 가져옵니다. [위치](https://hub.docker.com/r/jenkins/jenkins)

참고로 Docker Official Images로 등록된 Jenkins 이미지는 지원이 중단된 상태입니다. [참고](https://hub.docker.com/_/jenkins?tab=reviews)

**이 이미지로 설치하게 되면, 플러그인을 설치할 수 없습니다.**

LTS 버전을 받는 이유는 안정적인 동작을 위해서입니다.

```shell
$ docker run -d -p 8080:8080 -p 50000:50000 --name jenkins jenkins/jenkins:lts 
```

로 실행할 수 있습니다. 이렇게 하면, `/var/jenkins_home` 에 저장이 됩니다.

이는 영구적인 데이터가 아니므로 가능하다면 영구적인 볼륨으로 만드는 것이 좋다고 합니다.

```shell
$ docker run -d -p 8080:8080 -p 50000:50000 -v /your/home:/var/jenkins_home --name jenkins jenkins/jenkins:lts
```

jenkins 데이터를 `/your/home` 에 저장합니다.

이는 `jenkins user -uid 1000` 이 접근할 수 있도록 하거나, `-u some_other_user` 파라미터로 컨테이너가 실행될 리눅스 사용자 계정 이름 또는 UID를 설정할 수 있습니다.

위의 방법은 조금 어려우므로 다음과 같이 하는 방법을 호눅스가 추천하였습니다.

```shell
$ docker run -d -p 8080:8080 -p 50000:50000 -v /var/jenkins_home --name jenkins jenkins/jenkins:lts
```

-v 옵션은 docker volume을 사용하는 옵션입니다. [도커 volume 공식 문서](https://docs.docker.com/storage/volumes/)

> 학습 키워드: docker run `-u` 옵션, linux uid, gid, docker volume

