# 2020-04-28-TIL

## 오늘 할 일

- [ ] HttpEntity, ResponseEntity, RestTemplate 관련 공부
- [x] 자동 배포 시스템 만들기(톰캣 서비스 만들기)
- [ ] DB Mockup 테스트 코드 만들기
- [ ] scp 명령어 정리해서 gist에 올리기
- [ ] 알고리즘 문제 풀기
- [ ] 인프런 스프링 강의 듣기

## 톰캣 부팅시 시작하도록 하기

1. systemd에 서비스 등록(등록은 되는데 제대로 실행이 안 됨.)

   https://pinedance.github.io/blog/2017/09/12/Ubuntu-16.04-system-service-%EB%93%B1%EB%A1%9D%ED%95%98%EA%B8%B0

   [Systemd 에 대한 항목별 설명](https://victorydntmd.tistory.com/215)

   [간단 버전](https://nasanx2001.tistory.com/entry/%EC%9A%B0%EB%B6%84%ED%88%AC-1804-%EC%9E%90%EB%8F%99%EC%8B%A4%ED%96%89-%EC%84%9C%EB%B9%84%EC%8A%A4%EB%93%B1%EB%A1%9D)

2. init.d 로 서비스 등록하기(우분투 18.04에서 비권장)

   얘도 잘 안됨...

   오류는 `Failed to bind properties under 'spring.datasource.url' to java.lang.String:`

3. crontab 이용하기

   `@reboot /home/ubuntu/tomcat.sh >> /home/ubuntu/cron.log 2>&1`

   @reboot는 부팅되면 실행한다는 뜻!

환경변수 문제였다... cron에게 환경변수 지정이 안됐기 때문이었다.

[참고](https://stackoverflow.com/questions/51205164/script-file-restart-tomcat-runs-manually-success-but-fails-on-crontab)

