# 2020-05-28-TIL

## 오늘 할 일

- [ ] 예약 테이블 Mock data 생성
- [ ] 기간 검색 기능 구현 및 테스트 코드 작성
- [x] 요금관련 리뷰사항 보완 후 PR 보내기
- [x] 스크럼
- [x] 코드스쿼드 수업

### Dion
- 어제 한 일
    - DB 테이블 변경
    - 가격 검색기능 추가
    - 통화 변환 유틸 추가
    - 리뷰 내용 정리 후 의문점 질문
- 오늘 할 일
    - 통화 변환 유틸 PR 보내기
    - Mock Data 추가
    - 기간 검색기능 추가
    - rooms API 구현(동적쿼리 이용해야해서 아마 DAO 사용예정)
- 컨디션
    - 오늘도 기분이 좋습니다!

## 요금관련 리뷰사항 보완 후 PR 보내기

BigDecimal 테스트를 찾아보다가 https://github.com/joel-costigliola/assertj-examples를 찾았다.

## 코드스쿼드 수업(S3)

EC2 다음에 S3

Simple Storage Service

DB, Storage에 영구적으로 데이터를 저장함.

영구적으로 반드시 저장하는 데이터: 첨부파일, 그림 파일

영구적으로 저장할 필요는 없는 데이터: 다시 만들 수 있는 데이터(잠깐 저장한다.)

⇒ 일단 저장해두지만 삭제해도 괜찮다., 실수로 지워도 괜찮다.

주기적으로 삭제가 필요할 수 있는 데이터(개인정보, 로그-time series data, 시계열 데이터)

내구성, 가용성(분산 시스템이 가져야하는 두 가지 조건) → 스토리지가 가져야 하는 두가지 특성

스토리지 시스템은 내구성을 더 중요하게 생각한다.

### 백업

백업을 어디다가 하는가? 다른 EC2에 저장한다 (2copy) ⇒ failure rate 1%
절대 안쓴다.

3copy를 하는 편이 더 안전하다. ⇒ 근데 어렵고 복잡하다. 그러면 어떤 솔루션을 만들까?

hadoop을 이용하는 것이 더 안전하다.(분산 환경 시스템 ⇒ 홀수 대를 유지한다.) [과반수의 법칙]

분산 시스템은 스스로 살아있는지 확인한다.

검사하는 Master 서버가 있음(zookeeper, 자기들끼리 health check)

### 왜 S3를 제외한 서비스를 제공할까?

데이터마다 원하는 특성이 다 다르기 때문이다.

EBS: Elastic Block Store (EC2 저장공간) ⇒ 데이터가 날아갈 확률이 있다.

⇒ Snapshot: S3에 백업이미지를 저장함.

EFS: Network File System

⇒ 한 저장공간을 여러 컴퓨터가 사용(NAS 같은 것)

data는 locality가 있다. (지역성) 최근에 사용된 데이터가 저장되고, 그 주변의 데이터가 사용되는 경향성이 있다.

Data: hot data, cold data(자주 사용하지 않는 데이터)

Glacier는 Cold data를 저장하는 서비스(데이터의 용량이 큼)

일반적으로 Data는 90:10 10%의 데이터가 90% 접근을 한다.

저장하는 비용이 저렴하다.

성능이 낮다. 데이터를 불러오는데 4시간 정도 걸림.

AWS Snowball: 직접 옮겨주는 서비스

데이터의 특징, 특성, 규제(규정 준수)에 따라서 옵션을 선택해줘야 한다.

### EBS 보다 저렴한 EC2

데이터, 로그, 배포 결과물(Artifact)

정적 웹 페이지 저장소로도 사용가능 단독/Cloud Front(https)

public 저장소로 사용하거나, private 저장소로 사용

AWS에서 비싼 것 CPU, Network, Storage

S3 버킷에는 여러분의 지갑이 허용하는 만큼 저장할 수 있다.

같은 리전 내의 서비스 끼리의 네트워크 트래픽은 무료

### S3는 객체저장소

S3는 Prefix가 directory 처럼 사용될 수 있음

개발자는 prefix라고 인지해야지 folder라고 인지하면 안된다.

⇒ S3는 key를 기반으로 객체를 분산 저장하는 분산 저장소이다.

⇒ url이 key이기 때문에 prefix를 가질 경우 성능저하가 있다.(분산 저장소여서 비슷한 공간에 저장될 수도 있었다.)

key: url, value: Object

presigned url 다운로드 수, 만료시간 지정가능

.torrent를 쓰면 P2P 방식으로 공유가능하다.

