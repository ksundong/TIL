# 2020-02-12-TIL

## 오늘 할 일

- [x] https://d2.naver.com/helloworld/645609 읽어보기(호눅스의 추천!!) 꼭 읽자
- [x] [자바지기님 TDD 영상](https://www.youtube.com/watch?v=cVxqrGHxutU) 보기
- [ ] STEP4 Test Code 작성
- [x] 프로그래머스 2문제 풀기
- [x] 코어 운동

## Java의 날짜와 시간 API 정리

Java8 이전 Date, Calendar ⇒ 사용이 불편

↳ Joda-Time Library 등을 만들어서 사용.

Java8 이후 ⇒ 개선된 날짜와 시간 API 제공

**날짜와 시간계산은 사회제도나 과학에 복잡하게 얽혀있음**

1. 1582년 10월 4일의 다음날은? (10월 15일)

   ↳ 율리우스력의 누적오차를 그레고리력을 적용하면서 교정하기위해 10일을 건너뜀
   `Calendar.getInstance()` 는 역사와 천문학이 복잡하게 얽힘
   ↳ Locale 정보에 따라 다른 Calendar를 반환함.

2. 우리나라 1988년 5월 7일 23시의 1시간 후는 5월 8일 1시
   ↳ 일광시간절약제 때문(확인은 `TimeZone.inDaylightTime()` 으로 한다.)
   그러나 이는 실제와 다름(http://blog.benelog.net/3120317) 에서 변경해주셨다!
   Java는 **시간대 데이터베이스** 에 있는 데이터를 기반으로 계산한다.

3. 우리나라 표준시 관련 문제도 있었다.

4. 윤초문제
   윤초는 계산하지 않는다. 그로 인한 Linux + Java 기반 시스템의 문제가 있었음.
   Google은 'leap smear' 기법으로 해당 문제를 미리 방지하였다.

Date 클래스가 UTC를 정확히 반영하느지 여부는 JVM의 실행환경에 의존적이다. (대부분의 컴퓨터는 안됨)

윤초 때문에 OS, Java, Middle Ware, Application의 Malfunction이 예상된다.

↳ 그래서 없애자는 얘기도 나온다.

**결론: 날짜와 시간은 어렵고, 복잡한 영역이고 배경지식 또한 필요로 한다.**

### Calendar와 Date 클래스의 문제

1. 불변객체가 아니다.
   내부 속성이 변경가능하여, 다른 곳에서 변경하면 결과에 영향이 있을 수 있다.
2. int 상수필드의 남용
   엉뚱한 값을 넣어도 Exception등의 오류가 발생하지 않아 잘못된 값을 넣었는지 알 수가 없다.
3. 일관성 없는 요일 상수
   넣을 때랑, 받을 때랑 값이 다르다.
4. Date와 Calendar의 문제
   복잡한 날짜계산은 Calendar를 이용하게 되는데 불필요한 중간 객체일 수 있다.
   또한, Date는 날짜와, 시간 모두를 저장하는 클래스인데, 이름이 Date다.
5. 시간대 지정에 둔감하다.
6. 하위 클래스의 문제
   - `java.sql.Date` ⇒ 왜 이름이 겹치지?, Comparable을 클래스에서 선언안함.
   - `java.sql.Timestamp` ⇒ equals의 대칭성을 어김(Effective Java에 해당내용있음)

**결론: 짱 좋은 Java8 날짜 시간 API를 사용하자.**

추가로 `equals` 나, `hashcode`, `toString`을 Overriding할 때에는 반드시 자동화 도구를 이용하여 구현하자.
이건 아마, `@Override` 애노테이션을 안 붙인 분 때문에 나온 얘기가 아닐까..?

## 자바지기님 TDD영상 정리

의식적인 연습 ⇒ 그냥 연습이랑 다름, 효과적인 연습 방법(1만 시간의 재발견 인용)

5년 이상이 걸린 TDD와 Refactoring에 익숙해지기

- 테스트하기 쉬운 코드와 어려운 코드를 보는 눈
- 테스트하기 어려운 코드를 테스트하기 쉬운 코드로 설계하는 감

TDD와 Refactoring은 그만큼 어려운 활동임(많은 수련, 연습이 필요하다.)

⇒ 멋져보이지만 쉽게 접근할 수는 없음

❓더 효과적으로 연습할 수 없을까?

↳ 의식적인 연습이 필요.

의식적인 연습이란?

- 컴포트존을 벗어난 상태
- 구체적이고 명확한 목표
- 즉각적인 피드백을 받을 수 있도록 설계할 것
- 기존의 기술을 집중적으로 개선해서 발전시키고 수정하기
  ↳ **한 번에 많은 것을 하려고 하지 말라**

**계속해서 효과적인 연습방법을 고민해보자**

---

TDD와 단위테스트는 다르다.

1. 단위 테스트부터 만드는 연습을 해라

   1. Java Language Specification의 사용법을 익히기 위한 학습 테스트가 도움이 됨
      String, ArrayList 이런 것 부터 테스트 해보세요.
      이것만 잘해도 API에 친숙해질 수 있습니다.

      효과

      - 단위 테스트 방법
      - 단위 테스트 도구의 사용방법
      - API 학습효과

   2. 내가 만든 메서드 중 Util(Input → Output 이 일정한 메서드) 성격의 메서드로 연습한다.

   3. 알고리즘에 대한 검증을 단위테스트로 한다.
      Input, Output이 명확하기에 적용하기 좋다.

2. TDD 연습

   원칙 1. Toy Project에 적용한다.

   원칙 2. UI나 DB에 의존관계를 가지지 않는 요구사항으로 연습한다.

   **어려운 테스트를 컴포트 존으로 끌어내리기 위한 기법**

   예) 문자열 덧셈 계산기

   - 대략적인 TODO 만들기 (input → output 이 명확하면 됨)
   - TDD 사이클 중 리팩토링의 사이클은 뺀다. (fail → success cycle)
   - 위의 사항이 익숙해지면 refactoring을 한다.

3. Refactoring 연습

   1. 메서드 분리 잘하기

      - 들여쓰기 1단계로 만들기

      - else를 쓰지마라

      - 메서드가 정말 한 가지 일만 하고 있는가?

      - 로컬 변수가 필요할까? (메서드 자체를 인자로 던져준다.)

      - method compose pattern (동등한 수준의 작업을 하는 메서드로 나눈다.)

        연습할 때는 극단적으로 한다.

      - 전체적인 로직을 보이게 한다. (세부 구현은 보는 사람이 필요하면 보는 것.)
        ↳ 그래서 의미 있는 이름이 중요하다.(내생각)

      한 번에 다하려고 하지말고 하나씩 적용한다.(의식적인 연습)

      여유를 가지고 해보자

      극단적인 연습의 예, 메소드는 절대 15라인 → 10라인을 넘지않는다

      테스트가 있기에 변화에 자유롭다.

   2. 클래스 분리하기

      음수를 넣으면 Exception이 발생해야한다는 요구사항

      - 모든 원시값과 문자열은 포장해라(클래스로 만들어라) 예) Positive Class
      - 일급 콜렉션을 쓴다. (일급 콜렉션은 뭐지?)
      - 3개 이상의 인스턴스 변수를가진 클래스를 쓰지 않는다.
        ↳ 진짜 힘들지만 객체 설계 연습이 된다.

   3. 장난감 프로젝트 난이도 높이기

      게임, 의존관계 X, 약간은 복잡한 로직

   4. 의존관계를 추가해 난이도 높이기

      테스트 하기 쉬운코드, 어려운 코드를 보는 눈이 생김

      테스트하기 어려운 코드를 쉬운 코드로 설계하는 감이 생김

      더해서...

      - 컴파일 에러를 최소화하면서 리팩토링
      - E2E Test (ATDD 기반)
      - 레거시 애플리케이션에 테스트 코드 추가하고 리팩토링
        → 유지보수 능력이 좋은 개발자

   5. 그 밖에...

      파라미터 개수를 제한해보자

      여유, 토이 프로젝트, 인내력, **가보지 않은 길에 도전하는 용기** 를 가지자

**Q&A**

- 컴포트 존을 극복하는 방법: 삶에 여유와 에너지가 있어야 함.
- 남들 하는거 다하면서 절대 해낼 수 없다.
- 테스트 코드가 발목잡을 때: 설계가 잘못된 것이다.

## STEP4 Test Code 작성

테스트 코드 구현을 위해 테스트 하기 쉬운 코드로 변경하였는데, 상당히 귀찮은 작업이었다.

거의 Refactoring을 하는 수준으로 재구성 된 클래스가 많았다.

## 코딩테스트 문제 풀이

수박수박수박수박수박수? 완료

문자열을 정수로 바꾸기 완료

## 코어 운동

- [x] **전면 Level2**
- [x] **측면 Level1**
- [x] **후면 Level1**

## 맥에서 아이패드 충전이 제대로 안되는 경우

https://www.clien.net/service/board/lecture/11804930

맨 밑에 명령어를 쳐주면 된다고 한다.
나같은 경우에는 해피해킹 USB 단자에 꼽으면 전력이 필요하다고 뜨는데 그 때 Mac의 USB 포트에 꽂아주니 잘 되었다.

## 내일 할 일

- [ ] STEP4 테스트 코드 작성
- [ ] 코드스쿼드 강의 듣기
- [ ] 하체를 하고 싶은데 STEP4 테스트 코드가 작성이 되지 않으면 하지 않겠다...
- [ ] 프로그래머스 1문제 풀기
- [ ] 자바의 정석 1챕터 보기

